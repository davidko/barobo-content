/*! Pianobot 13-03-2015 */

var chapter1=angular.module("chapter1",["ngRoute","ui.bootstrap","hljs","ngSanitize"]);chapter1.config(["$routeProvider",function(a){a.when("/",{controller:"pianobotController",templateUrl:"views/pianobot.html"}).when("/lesson-one",{controller:"lessonOneController",templateUrl:"views/lesson-one.html"}).when("/lesson-two",{controller:"lessonTwoController",templateUrl:"views/lesson-two.html"}).when("/lesson-three",{controller:"lessonThreeController",templateUrl:"views/lesson-three.html"}).when("/lesson-four",{controller:"lessonFourController",templateUrl:"views/lesson-four.html"}).when("/lesson-five",{controller:"lessonFiveController",templateUrl:"views/lesson-five.html"}).when("/lesson-six",{controller:"lessonSixController",templateUrl:"views/lesson-six.html"}).otherwise({redirectTo:"/"})}]),chapter1.controller("pianobotController",["$scope","$timeout","robotFactory","util",function(a,b,c,d){function e(b){a.m.robot=b[0],a.m.robot.buzzerFrequency(0)}a.m={displayAllCode:!1,robot:null,running:!1},a.strike={},a.note={scientificPitch:{pitch:"a",octave:4},duration:500},a.toggle=function(){a.m.displayAllCode=!a.m.displayAllCode},a.run=function(){if(null!==a.m.robot){a.m.running=!0;var c=a.m.robot;c.buzzerFrequency(d.frequencyFromScientificPitch(a.note.scientificPitch)),b(function(){c.buzzerFrequency(0),a.m.running=!1},a.note.duration)}},a.stopAcquisition=function(){null===a.m.robot&&a.m.robot.buzzerFrequency(0),c.unregister()},a.strikeKey=function(b){a.strike=d.strikeFromEvent(b),d.startPlaying(b.target),null!==a.m.robot&&a.m.robot.buzzerFrequency(d.frequencyFromScientificPitch(a.strike.scientificPitch))},a.muteKey=function(b){a.strike instanceof d.Strike&&(d.stopPlaying(b.target),a.note=d.noteFromStrike(a.strike,b.timeStamp),a.strike={},null!==a.m.robot&&a.m.robot.buzzerFrequency(0))},a.swipeKey=function(b){a.strike instanceof d.Strike&&(d.stopPlaying(b.relatedTarget),a.note=d.noteFromStrike(a.strike,b.timeStamp),a.strikeKey(b))},a.leaveKey=function(b){d.isPianoKey(b.relatedTarget)||a.muteKey(b)},a.util=d,c.getRobots(e,1),Linkbots.setNavigationTitle("Pianobot"),Linkbots.setNavigationItems([{title:"Introductory Python",url:"/AppManagerApp/introductory_python/index.html"},{title:"Chapter 1",url:"#/"},{title:"Pianobot",url:"#/"}])}]).controller("lessonOneController",["$scope","$timeout","robotFactory",function(a,b,c){function d(b){a.m.robot=b[0],a.m.robot.buzzerFrequency(0)}a.m={buzzer:1046.5,displayAllCode:!1,robot:null,running:!1},a.toggle=function(){a.m.displayAllCode=!a.m.displayAllCode},a.run=function(){if(null!==a.m.robot){a.m.running=!0;var c=a.m.robot,d=parseFloat(a.m.buzzer);c.buzzerFrequency(d),b(function(){c.buzzerFrequency(0),a.m.running=!1},1500)}},a.stopAcquisition=function(){null!==a.m.robot&&a.m.robot.buzzerFrequency(0),c.unregister()},c.getRobots(d,1),Linkbots.setNavigationTitle("Lesson 1"),Linkbots.setNavigationItems([{title:"Introductory Python",url:"/AppManagerApp/introductory_python/index.html"},{title:"Chapter 1",url:"#/"},{title:"Lesson 1",url:"#/lesson-one"}])}]).controller("lessonTwoController",["$scope","$timeout","robotFactory",function(a,b,c){function d(b){a.m.robot=b[0],a.m.robot.buzzerFrequency(0)}function e(){var c=parseFloat(a.m.buzzer),d=1e3*parseFloat(a.m.sleep1),g=1e3*parseFloat(a.m.sleep2);a.m.robot.buzzerFrequency(c),b(function(){a.m.robot.buzzerFrequency(0),b(function(){f--,f>0?e():a.m.running=!1},g)},d)}var f=0;a.m={buzzer:1046.5,sleep1:.5,sleep2:.5,displayAllCode:!1,robot:null,running:!1},a.toggle=function(){a.m.displayAllCode=!a.m.displayAllCode},a.run=function(){null!==a.m.robot&&(a.m.running=!0,f=10,e())},a.stopAcquisition=function(){null!==a.m.robot&&a.m.robot.buzzerFrequency(0),c.unregister()},c.getRobots(d,1),Linkbots.setNavigationTitle("Lesson 2"),Linkbots.setNavigationItems([{title:"Introductory Python",url:"/AppManagerApp/introductory_python/index.html"},{title:"Chapter 1",url:"#/"},{title:"Lesson 2",url:"#/lesson-two"}])}]).controller("lessonThreeController",["$scope","$timeout","robotFactory",function(a,b,c){function d(b){a.m.robot=b[0],a.m.robot.buzzerFrequency(0)}function e(){var c=parseFloat(a.m.buzzer),d=1e3*parseFloat(a.m.sleep1),g=1e3*parseFloat(a.m.sleep2);a.m.robot.buzzerFrequency(c),b(function(){a.m.robot.buzzerFrequency(0),b(function(){f--,f>0?e():a.m.running=!1},g)},d)}var f=0;a.m={buzzer:1046.5,sleep1:1,sleep2:1,counter:5,displayAllCode:!1,robot:null,running:!1},a.toggle=function(){a.m.displayAllCode=!a.m.displayAllCode},a.run=function(){null!==a.m.robot&&(a.m.running=!0,f=Math.abs(parseInt(a.m.counter,10))%20,e())},a.stopAcquisition=function(){null!==a.m.robot&&a.m.robot.buzzerFrequency(0),c.unregister()},c.getRobots(d,1),Linkbots.setNavigationTitle("Lesson 3"),Linkbots.setNavigationItems([{title:"Introductory Python",url:"/AppManagerApp/introductory_python/index.html"},{title:"Chapter 1",url:"#/"},{title:"Lesson 3",url:"#/lesson-three"}])}]).controller("lessonFourController",["$scope","$timeout","robotFactory",function(a,b,c){function d(b){a.m.robot=b[0],a.m.robot.buzzerFrequency(0)}function e(){if(a.m.stop===!0)return a.m.robot.buzzerFrequency(0),void(a.m.running=!1);var c=a.m.kValues.map(function(a){return parseInt(a,10)}),d=Math.pow(2,(f-c[0])/c[1])*c[2],h=parseInt(a.m.decRange,10),i=parseInt(a.m.endRange,10);a.m.robot.buzzerFrequency(d),b(function(){return a.m.robot.buzzerFrequency(0),a.m.stop===!0?(a.m.robot.buzzerFrequency(0),void(a.m.running=!1)):void b(function(){return a.m.stop===!0?(a.m.robot.buzzerFrequency(0),void(a.m.running=!1)):(f+=h,g-=100,void(i>f?e():a.m.running=!1))},g)},g)}var f=0,g=1e3;a.m={startRange:33,endRange:53,decRange:2,kValues:[49,12,440],buzzer:1046.5,displayAllCode:!1,robot:null,running:!1,stop:!1},a.toggle=function(){a.m.displayAllCode=!a.m.displayAllCode},a.run=function(){null!==a.m.robot&&(a.m.running=!0,a.m.stop=!1,f=Math.abs(parseInt(a.m.startRange,10))%20,g=1e3,e())},a.stop=function(){a.m.stop=!0},a.stopAcquisition=function(){null!==a.m.robot&&a.m.robot.buzzerFrequency(0),c.unregister()},c.getRobots(d,1),Linkbots.setNavigationTitle("Lesson 4"),Linkbots.setNavigationItems([{title:"Introductory Python",url:"/AppManagerApp/introductory_python/index.html"},{title:"Chapter 1",url:"#/"},{title:"Lesson 4",url:"#/lesson-four"}])}]).controller("lessonFiveController",["$scope","$timeout","robotFactory",function(a,b,c){function d(b){a.m.robot=b[0],a.m.robot.buzzerFrequency(0)}function e(){if(f>=8)a.m.robot.buzzerFrequency(0),a.m.running=!1;else{var c=parseFloat(a.m.notes[f++]);a.m.robot.buzzerFrequency(c),b(e,500)}}var f=0;a.m={notes:[1046.5,1174.7,1318.5,1396.9,1568,1760,1975.5,2093,0],displayAllCode:!1,robot:null,running:!1},a.toggle=function(){a.m.displayAllCode=!a.m.displayAllCode},a.run=function(){null!==a.m.robot&&(a.m.running=!0,f=0,e())},a.stopAcquisition=function(){null!==a.m.robot&&a.m.robot.buzzerFrequency(0),c.unregister()},c.getRobots(d,1),Linkbots.setNavigationTitle("Lesson 5"),Linkbots.setNavigationItems([{title:"Introductory Python",url:"/AppManagerApp/introductory_python/index.html"},{title:"Chapter 1",url:"#/"},{title:"Lesson 5",url:"#/lesson-five"}])}]).controller("lessonSixController",["$scope","$timeout","robotFactory",function(a,b,c){function d(b){a.m.robot=b[0],a.m.robot.buzzerFrequency(0)}function e(){if(f>=27)a.m.robot.buzzerFrequency(0),a.m.running=!1;else{var c=parseFloat(a.m.notes[f]),d=1e3*parseFloat(a.m.sleeps[f++]);console.log(c),a.m.robot.buzzerFrequency(c),b(e,d)}}var f=0;a.m={notes:[1046.5,0,1046.5,0,1568,0,1568,0,1760,0,1568,0,1396.9,0,1396.9,0,1318.5,0,1318.5,0,1174.7,0,1174.7,0,1046.5],sleeps:[.25,.25,.25,.25,.5,.25,.25,.25,.25,.25,.25,.25,.5,.25,.25,.25,.25,.25,.25,.25,.25,.25,.25,.25,.5,.25],displayAllCode:!1,robot:null,running:!1},a.toggle=function(){a.m.displayAllCode=!a.m.displayAllCode},a.run=function(){null!==a.m.robot&&(a.m.running=!0,f=0,e())},a.stopAcquisition=function(){null!==a.m.robot&&a.m.robot.buzzerFrequency(0),c.unregister()},c.getRobots(d,1),Linkbots.setNavigationTitle("Lesson 6"),Linkbots.setNavigationItems([{title:"Introductory Python",url:"/AppManagerApp/introductory_python/index.html"},{title:"Chapter 1",url:"#/"},{title:"Lesson 6",url:"#/lesson-six"}])}]),chapter1.directive("contenteditable",["$sce",function(a){return{restrict:"A",require:"?ngModel",link:function(b,c,d,e){function f(){var a=c.html();d.stripBr&&"<br>"==a&&(a=""),isNaN(a)?(a=parseFloat(a.replace(/[^0-9\.]+/g,"")),isNan(a)&&(a=0),e.$setViewValue(a),c.html(a)):e.$setViewValue(a)}e&&(e.$render=function(){c.html(a.getTrustedHtml(e.$viewValue||""))},c.on("blur change",function(){b.$evalAsync(f)}),f())}}}]),chapter1.factory("robotFactory",["$interval",function(a){function b(){console.log("attempting robot acquisition");var h=Linkbots.acquire(e);return h.robots.length===e?(f(h.robots),g=h.robots,a.cancel(d),void(d=null)):(h.robots.length>0&&c(h.robots),void(null===d&&(d=a(b,1e3))))}function c(a){if(a.length>0)for(var b=0;b<a.length;b++)Linkbots.relinquish(a[b])}var d=null,e=0,f=function(){},g=[];Linkbots.managerEvents.on("changed",function(){g.length>0&&(c(g),g=[]),e>0&&b()});var h={};return h.getRobots=function(a,d){return f=a,e=d,g.length==e?f(g):void(g.length>0?(c(g),g=[],b()):b())},h.unregister=function(){f=function(){},e=0,null!==d&&(a.cancel(d),d=null)},h}]).factory("util",function(){var a={};return a.frequencyFromScientificPitch=function(a){var b={c:0,cs:1,d:2,ds:3,e:4,f:5,fs:6,g:7,gs:8,a:9,as:10,b:11},c=12*a.octave-8+b[a.pitch];return 440*Math.pow(2,(c-49)/12)},a.oneDecimal=function(a){return Math.round(10*a)/10},a.Strike=function(a,b){this.scientificPitch=a,this.timeStamp=b},a.Note=function(a,b){this.scientificPitch=a,this.duration=b},a.scientificPitchFromEvent=function(a){return{pitch:a.target.dataset.pitch,octave:a.currentTarget.dataset.octave}},a.strikeFromEvent=function(b){return new a.Strike(a.scientificPitchFromEvent(b),b.timeStamp)},a.noteFromStrike=function(b,c){var d=new Date(c)-new Date(b.timeStamp);return new a.Note(b.scientificPitch,d)},a.startPlaying=function(a){$(a).addClassSvg("playing")},a.stopPlaying=function(a){$(a).removeClassSvg("playing")},a.isPianoKey=function(a){return $(a).hasClassSvg("piano-key")},a}),function(a){a.fn.addClassSvg=function(a){return"undefined"!=typeof this.attr("class")?this.attr("class",this.attr("class")+" "+a):this.attr("class",a)},a.fn.removeClassSvg=function(a){if("undefined"!=typeof this.attr("class")){var b=this.attr("class").split(" ");return this.attr("class",b.filter(function(b){return b!=a}).join(" "))}return this},a.fn.hasClassSvg=function(a){return"undefined"!=typeof this.attr("class")?this.attr("class").split(" ").some(function(b){return b==a}):!1}}(jQuery);
//# sourceMappingURL=main.min.js.map